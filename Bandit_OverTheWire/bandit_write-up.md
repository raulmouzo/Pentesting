# Bandit Wargame Write-up

https://overthewire.org/wargames/bandit/

Connect with:

```
ssh bandit0@bandit.labs.overthewire.org -p2220
```

or 

```
sshpass -p 'bandit0' ssh bandit0@bandit.labs.overthewire.org -p 2220
```

If you can't clear the terminal with Ctrl + L use the command: `export TERM=xterm` 


## Level 0
- Password Location: password is stored in a file called **readme** located in the home directory.

```
$ cat readme
```

Password: `NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL`

## Level 1

- Password Location: password is stored in a file called "-" located in the home directory.

Error:
```
$ cat -
```

Possible solutions:
```
$ cat ./-
$ cat ~/-
$ cat /home/badit1/-
$ cat *
```

Password: `rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi`

## Level 2 

- Password Location: password is stored in a file called **spaces in this filename** located in the home directory.

Posible solutions:

```
$ cat "spaces in this filename"
$ cat spaces\ in\ this\ filename (with tab)
```

## Level 3
- Password Location: password is stored inside a **hidden** file within the "inhere" directory.
- Useful information: `man ls`

Posible solutions:

```
bandit3@bandit:~/inhere$ ls -la
total 12
drwxr-xr-x 2 root    root    4096 Apr 23 18:04 .
drwxr-xr-x 3 root    root    4096 Apr 23 18:04 ..
-rw-r----- 1 bandit4 bandit3   33 Apr 23 18:04 .hidden 

bandit3@bandit:~/inhere$ cat .hidden
```

Password: `2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe`


## Level 4 

- Password Location: The password for the next level is stored in the only **human-readable** file in the "inhere" directory.

- **Tip**: If your terminal is messed up, try the "reset" command

Possible solution: 

```
bandit4@bandit:~/inhere$ file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text   <--------
./-file08: data
./-file09: Non-ISO extended-ASCII text, with no line terminators
```
(We only found a file of type ASCII text, which means that it is human-readable)

One liner: 

```
$ file ./* | grep ASCII | head -n 1 | awk '{print $1}' FS=':' | xargs cat
```


Password: `lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR`

## Level 5 

- Password Location: stored in a file somewhere under the inhere directory.
  - human-readable
  - 1033 bytes in size
  - not executable

- Useful information: `man find`

Possible solution:

```
$ find . -type f -readable -size 1033c ! -executable
./inhere/maybehere07/.file2
```

One liner: 
```
find . -type f -readable -size 1033c ! -executable | xargs cat | xargs
```

Password: `P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU`


## Level 6 

- Password Location: stored **somewhere** on the server.
  - owned by user bandit7
  - owned by group bandit6
  - 33 bytes in size

- Uselful information: 
  - `man find`
  - `2>/dev/null` -> https://linuxhint.com/two-dev-null-command-purpose/

Possible solution: 
```
$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null
```

One liner: 

```
$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null | xargs cat
```

Password: `z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S`

## Level 7 
- Password Location: password can be found in the file named "data.txt," right beside the word "millionth."
- Useful information: `man grep`

Possible solution: 
```
$ cat data.txt | grep "millionth"
```

One liner:
```
cat data.txt | grep "millionth" | awk '{print $2}'
```

Password: `TESKZC0XvTetK0S9xNwm25STk5iWrBvP`


## Level 8 

- Password location: password is stored in the file data.txt and is the only line of text that occurs only once.
- Useful information: `man sort` and `man uniq`

Possible solution: 
```
$ sort data.txt | uniq -u
```

Password: `EN632PlfYiZbn3PhVK3XOGSlNInNE00t`


## Level 9 

- Password Location: 
  - data.txt
  - human-readable
  - preceded by several "=" characters

- Useful info: `man strings`

Possible solution:

```
$ cat data.txt | strings | grep "==="
```

One liner: 
```
$ cat data.txt | strings | grep "===" | tail -n 1 | awk '{print $2}'
```

Password: `G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s`


## Level 10 

- Password Location: 
  - data.txt
  - base64 encoded data

- Useful information: `man base64` and `man awk`

Possible solution:
```
$ base64 -d data.txt
```

One liner: 
``` 
base64 -d data.txt | awk 'NF>1{print $NF}'
```

Password: `6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM`

## Level 11 

- Password Location: 
  - data.txt
  - rot13

- Useful information:  
  - `man tr`
  - [How to decode ROT13 using tr command](https://www.reddit.com/r/linux4noobs/comments/xnogal/how_to_decode_rot13_using_tr_command/)


Possible solution:
```
cat data.txt | tr [A-Za-z] [N-ZA-Mn-za-m] 
```

One liner:
```
cat data.txt | tr [A-Za-z] [N-ZA-Mn-za-m] | awk 'NF>1 {print $NF}'
```

**[EXTRA]** Solution with c code: 

We have created a [code in C](rot13.c) that allows encoding and decoding Rot13.

Password: `JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv`

## Level 12

- Password Location: 
  - data.txt
  - hexdump of a file repeatedly compressed

- Tip: create a directory under /tmp to work on.

Possible solution: 
The expected solution at this level is for the user to use `xxd` to obtain the first compressed file and then, with the `file` command, identify the type of compression and decompress it using tools like `gzip` or `bzip2`.

```
$ xxd -r data.txt file
$ file file                              
file: gzip compressed data, was "data2.bin", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581
$ mv file file.gz 
$ gzip -d file.gz
```

But in our case, we prefer to use the `7z` tool and a script that achieves it automatically.

You can find the script [here](decompressor_script.sh). (To make the script work, you must have tools like `xclip` or `sponge` installed.)

Password: `wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw`

## Level 13

- Password Location (there is no password):
  - stored in /etc/bandit_pass/bandit14
  - can only be read by user bandit14
  - get a private SSH key that can be used to log into the next level

- Useful information: `man ssh` 
Possible solution :
We need to copy the private key they provide us to our computer, and we'll name it id_rsa. Once we obtain it, we execute the following commands:

```
$ chmod 600 id_rsa 
$ ssh -i id_rsa bandit14@bandit.labs.overthewire.org -p 2220
```

Password: `fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq`

## Level 14

- Password Location:
  - Submit the password of the current level to port 30000 on localhost.

- Useful information: `man nc`

Possible solution:
```
echo "fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq" | nc localhost 30000 
```

Password: `jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt`


## Level 15 

- Password Location:
  - Submitting the password of the current level to port 30001 on localhost using SSL encryption.

Possible solution: 

```
$ openssl s_client -connect localhost:30001
## Paste the password
Correct!
JQttfApK4SeyHwDlI9SXGR50qclOAil1

```

Password: `JQttfApK4SeyHwDlI9SXGR50qclOAil1`


## Level 16  

- Password Location: 
  - port on localhost in the range 31000 to 32000
  - port which speak SSL
  - 1 server will give the credentials of the next level

Possible solution: 
We can solve the level using nmap and testing manually all discovered ports: 
```
$ nmap --open -T5 -n -p31000-32000 localhost
Starting Nmap 7.80 ( https://nmap.org ) at 2023-08-01 12:15 UTC
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00010s latency).
Not shown: 996 closed ports
PORT  	STATE SERVICE
31046/tcp open  unknown
31518/tcp open  unknown
31691/tcp open  unknown
31790/tcp open  unknown
31960/tcp open  unknown
```

But we have decided to create a script that searches for all open ports that speak SSL, and then we manually check which one returns the password.

You can find the script [here](scanPorts.sh).

Password (RSA private key) [here](privatekey_bandit17).

## Level 17 

- Password Location:
  - 2 files: passwords.old and passwords.new 
  - The only line that has been changed between the files is the password

- Useful information: `man diff`

Possible solution:

```
$ diff passwords.old passwords.new
42c42 # the difference is in line 42 
< glZreTEH1V3cGKL6g4conYqZqaEj0mte # content of line 42 (passwords.old)
---
> hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg # content of line 42 (passwords.new)

```

One liner: 
```
diff passwords.old passwords.new  | tail -n 1  | awk '{print $2}'

```

Password: `hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg`


## Level 18 

- Password Location:
  - Password stored in readme
  - `~/.bashrc` modified to log out when you log in with SSH.


Possible solutions: 

```
# Command injection before the ~/.bashrc configuration file is processed.
$ ssh bandit18@bandit.labs.overthewire.org -p 2220 bash 

# Explicitly specifying the shell to be /bin/sh, ~/.bashrc won't be loaded.
$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t /bin/sh 
```

Password: `awhqfNnAbc1naukrpqDYcF95h7HoMTrC`

## Level 19 

- Password Location:
  - Setuid file in the homedirectory
  - Password stored in `/etc/bandit_pass`

- Useful information: [Exceptional file permissions (see line 236)](../README.md)

Possible solution: 
```
./bandit20-do sh # Get a sh tty
./bandit20-do bash -p # Get a bash tty
./bandit20-do cat /etc/bandit_pass/bandit20 # Get the password directly as bandit20
```

Password: `VxCazJaVykI6W36BkBU0mJTCM8rR95XT`

## Level 20

- Password Location:
  - Suid binary that makes connection to localhost <port>
  - This binary reads a line of text and if it matches the bandit19 password, it returns the next password.

- Useful information: `man tmux` and `man nc`

Possible solution:
```
# We start tmux, and with Ctrl + B and C, we create a new terminal and split it with Ctrl + B and %
$ tmux

# First window, after creating a file with the Bandit 19 password (pass.txt)
$ nc -l 8008 < pass.txt

# Second window: 
$ ./suconnect 8008
```

Password: `NvEJF7oVjkddltPSrdKEFOllh9V1IBcq`

