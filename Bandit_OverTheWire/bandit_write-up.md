# Bandit Wargame Write-up

https://overthewire.org/wargames/bandit/

Connect with:

```
ssh bandit0@bandit.labs.overthewire.org -p2220
```

or 

```
sshpass -p 'bandit0' ssh bandit0@bandit.labs.overthewire.org -p 2220
```

If you can't clear the terminal with Ctrl + L use the command: `export TERM=xterm` 


## Level 0
- Password Location: password is stored in a file called **readme** located in the home directory.

```
$ cat readme
```

Password: `NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL`

## Level 1

- Password Location: password is stored in a file called "-" located in the home directory.

Error:
```
$ cat -
```

Possible solutions:
```
$ cat ./-
$ cat ~/-
$ cat /home/badit1/-
$ cat *
```

Password: `rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi`

## Level 2 

- Password Location: password is stored in a file called **spaces in this filename** located in the home directory.

Posible solutions:

```
$ cat "spaces in this filename"
$ cat spaces\ in\ this\ filename (with tab)
```

## Level 3
- Password Location: password is stored inside a **hidden** file within the "inhere" directory.
- Useful information: `man ls`

Posible solutions:

```
bandit3@bandit:~/inhere$ ls -la
total 12
drwxr-xr-x 2 root    root    4096 Apr 23 18:04 .
drwxr-xr-x 3 root    root    4096 Apr 23 18:04 ..
-rw-r----- 1 bandit4 bandit3   33 Apr 23 18:04 .hidden 

bandit3@bandit:~/inhere$ cat .hidden
```

Password: `2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe`


## Level 4 

- Password Location: The password for the next level is stored in the only **human-readable** file in the "inhere" directory.

- **Tip**: If your terminal is messed up, try the "reset" command

Possible solution: 

```
bandit4@bandit:~/inhere$ file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text   <--------
./-file08: data
./-file09: Non-ISO extended-ASCII text, with no line terminators
```
(We only found a file of type ASCII text, which means that it is human-readable)

One liner: 

```
$ file ./* | grep ASCII | head -n 1 | awk '{print $1}' FS=':' | xargs cat
```


Password: `lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR`

## Level 5 

- Password Location: stored in a file somewhere under the inhere directory.
  - human-readable
  - 1033 bytes in size
  - not executable

- Useful information: `man find`

Possible solution:

```
$ find . -type f -readable -size 1033c ! -executable
./inhere/maybehere07/.file2
```

One liner: 
```
find . -type f -readable -size 1033c ! -executable | xargs cat | xargs
```

Password: `P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU`


## Level 6 

- Password Location: stored **somewhere** on the server.
  - owned by user bandit7
  - owned by group bandit6
  - 33 bytes in size

- Uselful information: 
  - `man find`
  - `2>/dev/null` -> https://linuxhint.com/two-dev-null-command-purpose/

Possible solution: 
```
$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null
```

One liner: 

```
$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null | xargs cat
```

Password: `z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S`

## Level 7 
- Password Location: password can be found in the file named "data.txt," right beside the word "millionth."
- Useful information: `man grep`

Possible solution: 
```
$ cat data.txt | grep "millionth"
```

One liner:
```
cat data.txt | grep "millionth" | awk '{print $2}'
```

Password: `TESKZC0XvTetK0S9xNwm25STk5iWrBvP`


## Level 8 

- Password location: password is stored in the file data.txt and is the only line of text that occurs only once.
- Useful information: `man sort` and `man uniq`

Possible solution: 
```
$ sort data.txt | uniq -u
```

Password: `EN632PlfYiZbn3PhVK3XOGSlNInNE00t`


## Level 9 

- Password Location: 
  - data.txt
  - human-readable
  - preceded by several "=" characters

- Useful info: `man strings`

Possible solution:

```
$ cat data.txt | strings | grep "==="
```

One liner: 
```
$ cat data.txt | strings | grep "===" | tail -n 1 | awk '{print $2}'
```

Password: `G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s`


## Level 10 

- Password Location: 
  - data.txt
  - base64 encoded data

- Useful information: `man base64` and `man awk`

Possible solution:
```
$ base64 -d data.txt
```

One liner: 
``` 
base64 -d data.txt | awk 'NF>1{print $NF}'
```

Password: `6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM`

## Level 11 

- Password Location: 
  - data.txt
  - rot13

- Useful information:  
  - `man tr`
  - [How to decode ROT13 using tr command](https://www.reddit.com/r/linux4noobs/comments/xnogal/how_to_decode_rot13_using_tr_command/)


Possible solution:
```
cat data.txt | tr [A-Za-z] [N-ZA-Mn-za-m] 
```

One liner:
```
cat data.txt | tr [A-Za-z] [N-ZA-Mn-za-m] | awk 'NF>1 {print $NF}'
```

**[EXTRA]** Solution with c code: 

We have created a [code in C](rot13.c) that allows encoding and decoding Rot13.

Password: `JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv`

## Level 12

- Password Location: 
  - data.txt
  - hexdump of a file repeatedly compressed

- Tip: create a directory under /tmp to work on.

Possible solution: 
The expected solution at this level is for the user to use `xxd` to obtain the first compressed file and then, with the `file` command, identify the type of compression and decompress it using tools like `gzip` or `bzip2`.

```
$ xxd -r data.txt file
$ file file                              
file: gzip compressed data, was "data2.bin", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581
$ mv file file.gz 
$ gzip -d file.gz
```

But in our case, we prefer to use the `7z` tool and a script that achieves it automatically.

You can find the script [here](decompressor_script.sh). (To make the script work, you must have tools like `xclip` or `sponge` installed.)

Password: `wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw`

## Level 13

- Password Location (there is no password):
  - stored in /etc/bandit_pass/bandit14
  - can only be read by user bandit14
  - get a private SSH key that can be used to log into the next level

- Useful information: `man ssh` 
  
Possible solution :
We need to copy the private key they provide us to our computer, and we'll name it id_rsa. Once we obtain it, we execute the following commands:

```
$ chmod 600 id_rsa 
$ ssh -i id_rsa bandit14@bandit.labs.overthewire.org -p 2220
```

Password: `fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq`

## Level 14

- Password Location:
  - Submit the password of the current level to port 30000 on localhost.

- Useful information: `man nc`

Possible solution:
```
echo "fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq" | nc localhost 30000 
```

Password: `jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt`


## Level 15 

- Password Location:
  - Submitting the password of the current level to port 30001 on localhost using SSL encryption.

Possible solution: 

```
$ openssl s_client -connect localhost:30001
## Paste the password
Correct!
JQttfApK4SeyHwDlI9SXGR50qclOAil1

```

Password: `JQttfApK4SeyHwDlI9SXGR50qclOAil1`


## Level 16  

- Password Location: 
  - port on localhost in the range 31000 to 32000
  - port which speak SSL
  - 1 server will give the credentials of the next level

Possible solution: 
We can solve the level using nmap and testing manually all discovered ports: 
```
$ nmap --open -T5 -n -p31000-32000 localhost
Starting Nmap 7.80 ( https://nmap.org ) at 2023-08-01 12:15 UTC
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00010s latency).
Not shown: 996 closed ports
PORT  	STATE SERVICE
31046/tcp open  unknown
31518/tcp open  unknown
31691/tcp open  unknown
31790/tcp open  unknown
31960/tcp open  unknown
```

But we have decided to create a script that searches for all open ports that speak SSL, and then we manually check which one returns the password.

You can find the script [here](scanPorts.sh).

Password (RSA private key) [here](privatekey_bandit17).

## Level 17 

- Password Location:
  - 2 files: passwords.old and passwords.new 
  - The only line that has been changed between the files is the password

- Useful information: `man diff`

Possible solution:

```
$ diff passwords.old passwords.new
42c42 # the difference is in line 42 
< glZreTEH1V3cGKL6g4conYqZqaEj0mte # content of line 42 (passwords.old)
---
> hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg # content of line 42 (passwords.new)

```

One liner: 
```
diff passwords.old passwords.new  | tail -n 1  | awk '{print $2}'

```

Password: `hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg`


## Level 18 

- Password Location:
  - Password stored in readme
  - `~/.bashrc` modified to log out when you log in with SSH.


Possible solutions: 

```
# Command injection before the ~/.bashrc configuration file is processed.
$ ssh bandit18@bandit.labs.overthewire.org -p 2220 bash 

# Explicitly specifying the shell to be /bin/sh, ~/.bashrc won't be loaded.
$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t /bin/sh 
```

Password: `awhqfNnAbc1naukrpqDYcF95h7HoMTrC`

## Level 19 

- Password Location:
  - Setuid file in the homedirectory
  - Password stored in `/etc/bandit_pass`

- Useful information: [Exceptional file permissions (see line 236)](../README.md)

Possible solution: 
```
./bandit20-do sh # Get a sh tty
./bandit20-do bash -p # Get a bash tty
./bandit20-do cat /etc/bandit_pass/bandit20 # Get the password directly as bandit20
```

Password: `VxCazJaVykI6W36BkBU0mJTCM8rR95XT`

## Level 20

- Password Location:
  - Suid binary that makes connection to localhost <port>
  - This binary reads a line of text and if it matches the bandit19 password, it returns the next password.

- Useful information: `man tmux` and `man nc`

Possible solution:
```
# We start tmux, and with Ctrl + B and C, we create a new terminal and split it with Ctrl + B and %
$ tmux

# First window, after creating a file with the Bandit 19 password (pass.txt)
$ nc -l 8008 < pass.txt

# Second window: 
$ ./suconnect 8008
```

Password: `NvEJF7oVjkddltPSrdKEFOllh9V1IBcq`

## Level 21

- Password Location:
  - Program running at regular interval of cron
  - `/etc/cron.d/` 

Possible solution:

```
$ cd /etc/cron.d

$ cat cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null

$ cat /usr/bin/cronjob_bandit22.sh
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv

$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff   # bandit21 password
```

Password: `WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff`

## Level 22
 
- Password Location: 
  - Program running at regular interval of cron
  - `/etc/cron.d`


Possible solution:

```
$ cd /etc/cron.d 

$ cat cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null


$ cat /usr/bin/cronjob_bandit23.sh

#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"

cat /etc/bandit_pass/$myname > /tmp/$mytarget


$ cat /tmp/$(echo "I am user bandit23" | md5sum | cut -d ' ' -f 1)
QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G

```

Password: `QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G`


## Level 23

- Password Location:
  - Program running at regular interval of cron
  - `/etc/cron.d`
  - (Need a script)


Possible solution:

```
$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname/foo || exit 1
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
	if [ "$i" != "." -a "$i" != ".." ];
	then
    	echo "Handling $i"
    	owner="$(stat --format "%U" ./$i)"
    	if [ "${owner}" = "bandit23" ]; then
        	timeout -s 9 60 ./$i
    	fi
    	rm -rf ./$i
	fi
done

```

Create a new script in `/var/spool/bandit24/foo`

```
#!/bin/bash

mkdir /tmp/tmp_pass
cd /tmp/tmp_pass

cat /etc/bandit_pass/bandit24 > pass

```

After creating the new script, give it execution permissions:

```
$ chmod 777 script.sh # Very IMPORTANT!
```

Once executed (by cron, every minute), the password will be stored in `/tmp/tmp_pass/pass`:

```
$ cat /tmp/tmp_pass/pass
VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar
```


Password: `VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar`


## Level 24

- Password Location: 
  - Daemon listening on port 30002
  - Need password of bandit24 and PIN (4-digit)
  - Brute-Forcing

Possible combinations: 10 ^ 4 = 100000 combinations

Possible solution: 
[Bash script](brute.sh) that tests all combinations with **a single connection**.

Password: `p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d`

## Level 25

- Password Location:
  - Shell for user bandit26 is not /bin/bash
  - Find out what it is, how it works and how to break out of it.

- Useful information: `man more` and 


Possible solution:

1. View the default shell of the user `bandit26`

```
$ grep "bandit26" /etc/passwd
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext

$ cat /usr/bin/showtext
#!/bin/sh

export TERM=linux

exec more ~/text.txt
exit 0
```   

2. Connect with sshkey

```
ssh -i bandit26.sshkey bandit26@localhost -p 2220 
```

3. Resize the window in such a way that the `more` command can act on the text displayed upon entry. By using this command, we can enter visual mode with the `v` key, exit with `esc`, and by using `:set shell=/bin/bash` and `:shell` , we can obtain a bash shell.

4. Now we have a setuid executable that allows us to view the password for bandit27.

```
$ ./bandit27-do cat /etc/bandit_pass/bandit27
```

Password: `c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1`



## Level 26

We obtain the level 27 password on the previous level.

Password: `YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS`

## Level 27

- Password Location:
  - `ssh://bandit27-git@localhost/home/bandit27-git/repo` via the port `2220` 
  - `bandit27-git` has the same password than `bandit27`


Possible solution:

```

$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo
$ cd repo 
$ cat README

```

Password: `AVanL161y9rsbcJIsFHuw35rjaOM19nR`


## Level 28

- Password Location: 
  - `ssh://bandit28-git@localhost/home/bandit28-git/repo` via the `port 2220`
  - `bandit28-git` has the same password than `bandit28`


Possible solution: 

```
$ mktemp -d
/tmp/tmp.ld7lvC6D6S

$ cd /tmp/tmp.ld7lvC6D6S

$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo

$ cd repo/

$ git show

commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -> master, origin/master, origin/HEAD)
Author: Morla Porla <morla@overthewire.org>
Date:   Sun Apr 23 18:04:39 2023 +0000

	fix info leak

diff --git a/README.md b/README.md
index b302105..5c6457b 100644
--- a/README.md
+++ b/README.md
@@ -4,5 +4,5 @@ Some notes for level29 of bandit.
 ## credentials
 
 - username: bandit29
-- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S
+- password: xxxxxxxxxx
 
```

Password: `tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S`

## Level 29 

- Password Location: 
  - `ssh://bandit29-git@localhost/home/bandit29-git/repo ` via the `port 2220`
  - `bandit29-git` has the same password than `bandit29`


Possible solution: 

```
$ git branch -a
* master
  remotes/origin/HEAD -> origin/master
  remotes/origin/dev
  remotes/origin/master
  remotes/origin/sploits-dev

$ git checkout dev
Branch 'dev' set up to track remote branch 'dev' from 'origin'.
Switched to a new branch 'dev'

$ git show
commit 13e735685c73e5e396252074f2dca2e415fbcc98 (HEAD -> dev, origin/dev)
Author: Morla Porla <morla@overthewire.org>
Date:   Sun Apr 23 18:04:40 2023 +0000

	add data needed for development

diff --git a/README.md b/README.md
index 1af21d3..a4b1cf1 100644
--- a/README.md
+++ b/README.md
@@ -4,5 +4,5 @@ Some notes for bandit30 of bandit.
 ## credentials
 
 - username: bandit30
-- password: <no passwords in production!>
+- password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS
 
```

Password: `xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS`

## Level 30 

- Password Location:
  - `ssh://bandit30-git@localhost/home/bandit30-git/repo ` via the `port 2220`
  - `bandit30-git` has the same password than `bandit30`


Possible solution:

```
$ git tag
secret

$ git show secret
OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt

```

Password: `OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt`

## Level 31

```
$ cat README.md
This time your task is to push a file to the remote repository.


Details:
	File name: key.txt
	Content: 'May I come in?'
	Branch: master


$ la
.git  .gitignore  README.md

$ cat .gitignore
*.txt

$ echo "May I come in?" > key.txt

$ git add -f key.txt

$ git status
On branch master
Your branch is up to date with 'origin/master'.


Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
    new file:   key.txt


$ git commit -m "my commit"
[master 3499eae] my commit
 1 file changed, 1 insertion(+)
 create mode 100644 key.txt

$ git push
.
.
.

remote: ### Attempting to validate files... ####
remote:
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote:
remote: Well done! Here is the password for the next level:
remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y

```

Password: `rmCBvG56y58BXzv98yZGdO7ATVL5dW8y`

## Level 32

- Password Location: 
  - ?

Possible solution: 
```
>> $0

$ bash

$ cat /etc/bandit_pass/bandit33
odHo63fHiFqcWWJG9rLiLDtPm45KzUKy

```

Password: `odHo63fHiFqcWWJG9rLiLDtPm45KzUKy`